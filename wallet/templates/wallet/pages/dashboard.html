{% extends "wallet/components/base.html" %}
{% load static %}
{% load wallet_extras %}

{% block content %}

    <!--suppress HtmlUnknownTarget, XmlInvalidId -->
    <div id="dashboard" class="triangle-content">

        {# message box #}
        <div class="row">
            <div class="col s6 offset-s3">
                {% include 'wallet/components/message_box.html' %}
            </div>
        </div>

        <div class="row">
            <div class="col s8 offset-s2 content">
                <div class="row">
                    <div class="col s4 offset-s4 card horizontal" id="balance-card">
                        <div class="card-content center-align">
                            <span class="card-title">Balance</span>
                            <p class="user-balance">{{ balance|iota_display_format }}</p>
                            <p class="user-mail">{{ request.user.email }}</p>
                        </div>
                        <div class="card-image">
                            <img src="{% static 'wallet/img/iota-logo.png' %}" alt="IOTA Logo">
                        </div>
                    </div>
                </div>
                <div class="row recent-transactions">

                    <div id="transactions-loading-container">
                        <h1>Loading recent Transactions</h1>
                        <div class="progress col s8 offset-s2">
                            <div class="indeterminate"></div>
                        </div>
                    </div>

                    <div id="transaction-ready-container" style="display: none;">
                        <h1>Recent Transactions</h1>
                    </div>
                </div>
            </div>
        </div>

    </div>
{% endblock %}

{% block custom_scripts %}
    <script>
        $(document).ready(function () {

            // fetch transactions and update UI
            window.bundle.fetchDashboardTransactions(function (transactionsHtml) {

                // append list of transactions
                $('#transaction-ready-container').append(transactionsHtml);

                // show in UI
                $('#transactions-loading-container').fadeOut(200, function () {
                    $('#transaction-ready-container').fadeIn();
                });

                window.bundle.initCollapsible();
            });

            {% if message %}
                // show message
                window.bundle.showMessageBox('{{ message }}', '{{ message_type|default:"info" }}');
            {% endif %}
        });
    </script>
{% endblock %}